---
title: "Penguins"
output:
  html_document:
    toc: yes
    toc_float: yes
    number_sections: yes
    toc_collapsed: yes
    code_folding: hide
    code_download: yes
    smooth_scroll: yes
    theme: lumen
  pdf_document:
    toc: yes
editor_options:
  chunk_output_type: inline
---
<style type="text/css">

  pre code {
    display: block;
    margin-left: 0;
  }

  div#TOC li {
    list-style: none;
    background-color: lightgray;
    background-image: none;
    background-repeat: none;
    background-position: 0;
    font-family: Arial, Helvetica, sans-serif;
    color: #780c0c;
  }

  h1.title {
    font-size: 24px;
    color: darkblue;
    text-align: center;
    font-family: Arial, Helvetica, sans-serif;
    font-variant-caps: normal;
  }
h4.author { font-size: 18px;
font-family: Arial, Helvetica, sans-serif;
color: navy;
text-align: center;
}
h4.date { font-size: 18px;
font-family: Arial, Helvetica, sans-serif;
color: darkblue;
text-align: center;
}

h1 {
font-size: 22px;
font-family: "Times New Roman", Times, serif;
color: darkred;
text-align: left;
}
h2 {
font-size: 18px;
font-family: "Times New Roman", Times, serif;
color: navy;
text-align: left;
}
h3 { font-size: 15px;
font-family: "Times New Roman", Times, serif;
color: darkred;
text-align: left;
}
h4 {
font-size: 18px;
font-family: "Times New Roman", Times, serif;
color: darkred;
text-align: left;
}


a:link {
color: green;
}

a:visited {
color: purple;
}

a:hover {
color: red;
}

a:active {
color: yellow;
}

```{r setup, include=FALSE}
options(repos = list(CRAN="http://cran.rstudio.com/"))
# code chunk specifies whether the R code, warnings, and output 
# will be included in the output files.
if (!require("tidyverse")) {
   install.packages("tidyverse")
   library(tidyverse)
}
if (!require("knitr")) {
   install.packages("knitr")
   library(knitr)
}
if (!require("cowplot")) {
   install.packages("cowplot")
   library(cowplot)
}
if (!require("latex2exp")) {
   install.packages("latex2exp")
   library(latex2exp)
}
if (!require("plotly")) {
   install.packages("plotly")
   library(plotly)
}
if (!require("gapminder")) {
   install.packages("gapminder")
   library(gapminder)
}
if (!require("png")) {
    install.packages("png")             # Install png package
    library("png")
}
if (!require("RCurl")) {
    install.packages("RCurl")             # Install RCurl package
    library("RCurl")
}
if (!require("colourpicker")) {
    install.packages("colourpicker")              
    library("colourpicker")
}
if (!require("gganimate")) {
    install.packages("gganimate")              
    library("gganimate")
}
if (!require("gifski")) {
    install.packages("gifski")              
    library("gifski")
}
if (!require("magick")) {
    install.packages("magick")              
    library("magick")
}
if (!require("grDevices")) {
    install.packages("grDevices")              
    library("grDevices")
}
if (!require("jpeg")) {
    install.packages("jpeg")              
    library("jpeg")
}
if (!require("VGAM")) {
    install.packages("VGAM")              
    library("VGAM")
}
if (!require("MASS")) {
    install.packages("MASS")              
    library("MASS")
}
if (!require("nnet")) {
    install.packages("nnet")              
    library("nnet")
}
if (!require("cluster")) {
    install.packages("cluster")              
    library("cluster")
}

knitr::opts_chunk$set(echo = TRUE,       
                      warning = FALSE,   
                      result = TRUE,   
                      message = FALSE,
                      comment = NA)
```
</style>
<h1 class="title toc-ignore">Getting Started with Base R Graphics</h1>
<h4 class="author">Edward Coleman</h4>
<h4 class="date">West Chester University</h4>
<div id="base-plotting-functions" class="section level1" number="1">
<h1><span class="header-section-number">1</span> First Plots</h1>
<div class="figure" style="text-align: center">
```{r}
pen <- read.csv("https://ecoleman451.github.io/ecoleman/w3/w03-penguins.csv")
plot(pen$bill_length_mm, pen$flipper_length_mm)
title(main = "Penguin Bill & Flipper Lengths")
```

<div class="figure" style="text-align: center">
<p class="caption">
Base plot with annotation: Iris
</p>
</div>
<p>Here, I start with the same plot as above (although I add the title
right away using the main argument to <code>plot()</code>) and then
annotate it by coloring blue the data points corresponding.</p>
```{r}
bill_length = pen$bill_length_mm
flipper_length = pen$flipper_length_mm
species = pen$species

adelie.id = which(species =="Adelie")
chinstrap.id = which(species =="Chinstrap")
gentoo.id = which(species =="Gentoo")

plot(bill_length, flipper_length, main = "Penguin Bill & Flipper Length")
points(bill_length[chinstrap.id], flipper_length[chinstrap.id], pch=19, col="blue")
points(bill_length[adelie.id], flipper_length[adelie.id], pch=19, col="red")
points(bill_length[gentoo.id], flipper_length[gentoo.id], pch=19, col="green")
```

</div>
<div class="figure" style="text-align: center">
<div id="controlling-point-size-and-transparency" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Final Plot (Controlling Point Size
and Transparency)</h1>
<p>we use <code>cex=</code> and <code>alpha=</code> to control the point
size according to the value of a variable and the level of transparency
of the point.</p>
```{r}
pen.img <- "https://ecoleman451.github.io/ecoleman/w3/img/penguin.jpeg"
my.pen <- readJPEG(getURLContent(pen.img))
raster.pen <- as.raster(my.pen)

bill_length = pen$bill_length_mm
flipper_length = pen$flipper_length_mm
species = pen$species
body_mass = (pen$body_mass_g/5000)

adelie.id = which(species =="Adelie")
chinstrap.id = which(species =="Chinstrap")
gentoo.id = which(species =="Gentoo")

plot(bill_length, flipper_length, main = "Bill Length vs Flipper Length by Body Mass")
## change the point size based on their average of Bill and Flipper lengths
points(bill_length[adelie.id], flipper_length[adelie.id], 
       pch = 19, col = "red", cex = body_mass[adelie.id])
points(bill_length[chinstrap.id], flipper_length[chinstrap.id], 
       pch = 19, col = "blue", cex = body_mass[chinstrap.id])
points(bill_length[gentoo.id], flipper_length[gentoo.id], 
       pch = 19, col = "green", cex = body_mass[gentoo.id])
legend("topleft", c("adelie", "chinstrap", "gentoo"), col = c("red", "blue", "green"),
                  pch=c(18, 19, 20))
rasterImage(raster.pen,6,3.5,7,4.4)
text(7.25, 2.25, "The size is proportional to body mass", col = "purple", cex = 0.5)
```
<p>We can see in the plot above that Gentoo penguins, when compared to Chinstrap & Adelie penguins, tend to have a larger flipper & bill length and is linearly positive. The chinstrap species has a linearly positive trend as well, with its bill length much larger in proportion to its flipper length. The Adelie species has a slightly positive linear relationship with bill lenght and flipper length, although its flipper lengths seem to have the lowest values when compared to Chinstrap and Gentoo penguins.</p>
